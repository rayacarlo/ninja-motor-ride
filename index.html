<!DOCTYPE html>
<html lang="es">
<head>
	<title>Ninja Motor Ride</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" type="image/png" href="images/icons/favico.ico"/>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
</head>
<body>

	<div class="bg-contact3" style="background-image: url('images/road-vector.jpg');">
		<div class="container-contact3">
			<div class="wrap-contact3">
				<form class="contact3-form validate-form">
					<span class="contact3-form-title">Calcula tu consumo</span>

					<select class="custom-select my-2" id="origen">
						<option value>Selecciona tu ciudad de origen</option>
						<option value="actual" id="actual">Usar mi ubicación actual</option>
						<option value="-18.4746,-70.29792">Arica</option>
						<option value="-20.21326,-70.15027">Iquique</option>
						<option value="-23.65236,-70.3954">Antofagasta</option>
						<option value="-29.90453,-71.24894">La Serena</option>
						<option value="-29.95332,-71.33947">Coquimbo</option>
						<option value="-33.036,-71.62963">Valparaíso</option>
						<option value="-33.02457,-71.55183">Viña del Mar</option>
						<option value="-33.45694,-70.64827">Santiago</option>
						<option value="-34.17083,-70.74444">Rancagua</option>
						<option value="-35.4264,-71.65542">Talca</option>
						<option value="-36.82699,-73.04977">Concepción</option>
						<option value="-36.72494,-73.11684">Talcahuano</option>
						<option value="-36.60664,-72.10344">Chillán</option>
						<option value="-38.73965,-72.59842">Temuco</option>
						<option value="-41.4693,-72.94237">Puerto Montt</option>
					</select>

					<select class="custom-select my-2" id="destino">
						<option value>Selecciona tu ciudad de destino</option>
						<option value="-18.4746,-70.29792">Arica</option>
						<option value="-20.21326,-70.15027">Iquique</option>
						<option value="-23.65236,-70.3954">Antofagasta</option>
						<option value="-29.90453,-71.24894">La Serena</option>
						<option value="-29.95332,-71.33947">Coquimbo</option>
						<option value="-33.036,-71.62963">Valparaíso</option>
						<option value="-33.02457,-71.55183">Viña del Mar</option>
						<option value="-33.45694,-70.64827">Santiago</option>
						<option value="-34.17083,-70.74444">Rancagua</option>
						<option value="-35.4264,-71.65542">Talca</option>
						<option value="-36.82699,-73.04977">Concepción</option>
						<option value="-36.72494,-73.11684">Talcahuano</option>
						<option value="-36.60664,-72.10344">Chillán</option>
						<option value="-38.73965,-72.59842">Temuco</option>								
						<option value="-41.4693,-72.94237">Puerto Montt</option>
					</select>

					<select class="browser-default custom-select my-2" id="vehiculo">
						<option value>Selecciona tu vehículo</option>
						<option value="mitsubishi">Mitsubishi L200 Dakar</option>
						<option value="chevrolet">Chevrolet Sail</option>
						<option value="kia">Kia Rio 3</option>
						<option value="suzuki">Suzuki Baleno</option>
					</select>
					
					<div class="modal fade" id="myModal" role="dialog">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header" style="padding:35px 50px;">
								<h4><span class="glyphicon glyphicon-lock"></span> Para el tramo seleccionado:</h4>
								</div>
								<div class="modal-body" style="padding:40px 50px;">
								<form role="form">
									<div class="form-group">
									<label for="distancia"><span class="glyphicon glyphicon-user"></span> La distancia en kilómetros</label>
									<input readonly type="text" class="form-control" id="distancia" placeholder="0 kms">
									</div>
									<div class="form-group">
									<label for="consumo"><span class="glyphicon glyphicon-eye-open"></span> El consumo de combustible</label>
									<input readonly type="text" class="form-control" id="comsumo" placeholder="0 lts">
									</div>
								</form>
								</div>
									<div class="modal-footer">
									<button type="submit" class="btn btn-danger btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cerrar</button>
									</div>
								</div>
						  
							</div>
					  	</div> 
					<div class="container-contact3-form-btn">
						<button type="button" class="contact3-form-btn" id="btn-calcular" data-toggle="modal" data-target="#myModal">Calcular</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

	<script>

		class Vehiculo {
			get_consumo(km){
				throw new Error('No implementado');
			}
		}

        class Mitsubishi extends Vehiculo{
            get_consumo(km){
				return km / 16;
			}
        }

        class Chevrolet extends Vehiculo{
            get_consumo(km){
				return km / 19;
			}
        }

        class Kia extends Vehiculo{
            get_consumo(km){
				return km / 23;
			}
        }

        class Suzuki extends Vehiculo{
            get_consumo(km){
				return km / 21;
			}
        }

		const get_fetch = function(origen, destino, ciudad_origen, ciudad_destino, vehiculo){
			
			fetch(`https://maps.googleapis.com/maps/api/distancematrix/json?origins=${ciudad_origen}&destinations=-${ciudad_destino}&key=AIzaSyAlDSRLGoUqLzoFZQlR7wvyRoNdsufoQls`, {})
			.then(
				datos => datos.json()
			)
			.then(function(datos){
				debugger
				const consumo = vehiculo.get_consumo(datos.rows[0].elements[0].distance.value / 1000);
				const recorrido = datos.rows[0].elements[0].distance.text;
				const duracion = datos.rows[0].elements[0].duration.text;
			})
			.catch(function(error){
				alert(`Error: ${error}`);
			});
		}
		
		document.getElementById('btn-calcular').addEventListener('click', function(){
			$("#myModal").modal();
		
			const origen = document.getElementById("origen");
			const destino = document.getElementById("destino");
			const ciudad_origen = origen.options[origen.selectedIndex].value;
			const ciudad_destino = destino.options[destino.selectedIndex].value;
			const vehiculoid = document.getElementById("vehiculo").value;
			
			if (origen == "" || destino == "" || vehiculoid == ""){
				alert('Debes seleccionar las opciones')
				return;
			}

			let vehiculo;
			if (vehiculoid == 'mitsubishi') {vehiculo = new Mitsubishi()}
			else if (vehiculoid == 'chevrolet') {vehiculo = new Chevrolet()}
			else if (vehiculoid == 'kia') {vehiculo = new Kia()}
			else if (vehiculoid == 'suzuki') {vehiculo = new Suzuki()}
			
			if (origen == 'actual'){
				navigator.geolocation.getCurrentPosition(pos => {
					get_fetch(`${pos.coords.latitude},${pos.coords.longitude}`, destino, ciudad_origen, ciudad_destino, vehiculo);
				});
			} else {
				get_fetch(origen, destino, ciudad_origen, ciudad_destino, vehiculo);
			}
			
		});

	</script>

</body>
</html>
